
BNRP_createTCB"3691 N {idTCB18*1<idtcb1=;idtcb25=29(2;idTCB2<*30)ilBNRP_malloc32(3=CG(44idTCB45));idtcb4=p50ifspace52=58idtcb5:p5=ihfreePtr5?=67idtcb69p6<ihASTbase6>=76idtcb78p7;iiheapbase7==86idtcb89p8<ijtrailbase8>=98idtcb9:p9=ihenvbase9?=:7idtcb:9p:<igcpbase:>=;5idtcb;7p;:igspbase;<=<3idtcb<5p<8ifspend<:==0idtcb=3p=6ijemptyList=8=>2idtcb>4p>7ieppsw>9=>>CN;AL(?:(?;iiBNRP_TCB?<*A@E)idtcbA@G);}A@N
BNRP_initializeTCB"3988 N {nidres66;idres6==71itBNRP_initializeTask73(86(87idTCB88*8<)idtcb8?,92ioheap_trailSize94,:2ikenv_cpSize:3,:=ieNULL:>);DB(;8idres;9icEQ;=CN)(<3(<4idTCB<5*<9)idtcb<;)p<?iitaskName=1==:iuBNRPLookupPermSymbol=<(?0iename?1);AL(@OOidresA@@);}A@G
BNRP_terminateTCB"4278 N {(24(25idTCB26*2:)idtcb2<)p30ikvalidation32=3=CN;isBNRP_disposeMemory43(55(56idTCB57*5;)idtcb5=);AL(6:CN);}70
BNRP_disposeTCB"4417 N {(23(24idTCB25*29)idtcb2;)p2?ikvalidation31=3<CN;DB(4<(4=(4>idTCB4?*53)(55*56idtcb57))p5<iiheapbase5>icNE67CN)isBNRP_disposeMemory6=(7?(80idTCB81*85)*87idtcb88);ijBNRP_free8?(98(99EP*9?)*:1idtcb:2);*:9idtcb::=:>ieNULL;0;AL(;=CN);}<3
BNRP_bindPrimitive"4639 N {AL(4>irBNRPBindPrimitive4?(60iename61,65ijprocedure67)?CN:CM);}7=
BNRP_unify"4800 N {AL(49ifunify4:(4?(50idTCB51*55)idtcb57,5:ifterm15<,61ifterm263));}6=
BNRP_markheap"5118 N {EEilchoicepoint3=*49ifnewcp4:;EAilcriticalenv57;ifnewcp9>=:4(:6ilchoicepoint:7*;3)(;5(;6(;7idTCB;8*;<)idtcb;>)p<2idlcp<4-<8CG(=0ilchoicepoint=1));DB(>4(>5EA)ifnewcp>;icLE?1(?4(?5idTCB?6*?:)idtcb?<)pA@@ifcpendA@B)AL;ilcriticalenvACJ=ADF(ADH(ADI(ADJidTCBADK*ADO)idtcbAEA)pAEEidlcpAEGicEQAEK(AEN(AEOidTCBAF@*AFD)idtcbAFF)pAFJigcpbaseAFL)?(AGM(AGNidTCBAGO*AHC)idtcbAHE)pAHIihenvbaseAHK:(AIK(AILilchoicepointAIM*AJI)(AJK(AJL(AJMidTCBAJN*AKB)idtcbAKD)pAKHidlcpAKJ))pAKOiicriticalALA;DB(ALO(AM@(AMAidTCBAMB*AMF)idtcbAMH)pAMLicceAMNicGTANAilcriticalenvAND){ENcibnB@C;ibnB@K=B@M*B@O(BA@ENc*BAO)(BBA(BBBidTCBBBC*BBG)idtcbBBI)pBBMiccpBBO;ilcriticalenvBEF=BFB(BFD(BFEidTCBBFF*BFJ)idtcbBFL)pBG@icceBGB+BGE(BGG(BGHibnBGI+BGKCM)*BH@CG(BHHEA));}BICDB(BII(BIJilcriticalenvBIK+BJG(BJICM*BJLCG(BKDEA)))icGTBKM(BL@(BLAidTCBBLB*BLF)idtcbBLH)pBLLigenvendBLN)AL;ifnewcpCAOpCBDihnumRegsCBF=CBNCN;ifnewcpCDEpCDJiiprocnameCDL=CEEimBNRPmarkAtomCEG;ifnewcpCHFpCHKidbcpCHM=CIA(CIC(CIDidTCBCIE*CII)idtcbCIK)pCIOiccpCJA;ifnewcpCJFpCJKidbceCJM=CKA(CKC(CKDidTCBCKE*CKI)idtcbCKK)pCKOicceCLA;ifnewcpCLFpCLKicteCLM=CM@(CMB(CMCidTCBCMD*CMH)idtcbCMJ)pCMNicteCN@;ifnewcpCNEpCNJidlcpCNL=CO@(COBilchoicepointCOC*COO)(D@A(D@BidTCBD@C*D@G)idtcbD@I)pD@MidlcpD@O;ifnewcpDAEpDAJichpDAL=DAO(DBA(DBBidTCBDBC*DBG)idtcbDBI)pDBMichpDBO;ifnewcpDCDpDCIidkeyDCK=DCOCN;ifnewcpDFBpDFGidclpDFI=DFM(DFOEA)&DGEipBNRP_markClauseDGF;ifnewcpDHHpDHMiicriticalDHO=DIHilcriticalenvDIJ;iqBNRP_markFailureDMN=DNO(DOAEA)&DOGipBNRP_markClauseDOH+E@HCG(EA@ilclauseEntryEAA);iepushEB@(EBDieBYTEEBE,EBIiqBNRP_markFailureEBK,ECKCM);iepushEEA(EEEieBYTEEEF,EEJiqBNRP_markFailureEEL,EFLCM);iepushEHC(EHGieBYTEEHH,EHLiqBNRP_markFailureEHN,EINCM);ipBNRP_markClauseFEL.ibcFFL.iknextClauseFFN=FGIipBNRP_markClauseFGK.ibcFHK.irnextSameKeyClauseFHM=FIO&FJAipBNRP_markClauseFJB.ibcFKB;iepushGDN(GEBEA,GEGilcriticalenvGEI,GFDCN);iepushGGM(GHAEA,GHFilcriticalenvGHH,GIC(GIEEA)ifnewcpGIK);iepushGKF(GKJEA,GKOilcriticalenvGLA,GLLilcriticalenvGLN+GMICG(GN@EA));*H@M(H@NEA*HAD)ilcriticalenvHAF=HBB(HBD(HBEidTCBHBF*HBJ)idtcbHBL)pHC@iccpHCB;(HCG(HCHidTCBHCI*HCM)idtcbHCO)pHDCicceHDE=HDHilcriticalenvHDJ;iemarkHIMpHJAiedataHJC[HJGCN]=HJKilBNRP_markerHJM;iemarkHKKpHKOiedataHLA[HLECM]=HLI(HLKEA)ifnewcpHMA;iemarkHMIpHMMiedataHMO[HNCCM]=HNG(HNI(HNJidTCBHNK*HNO)idtcbHOA)pHOEicteHOG;iemarkHOLpI@@iedataI@B[I@FCM]=I@J(I@L(I@MidTCBI@N*IAB)idtcbIAD)pIAHiiprocnameIAJ;iemarkIBEpIBIiedataIBK[IBOCM]=ICC(ICE(ICF(ICG(ICHidTCBICI*ICM)idtcbICO)pIDCieppswIDE&IDJimisolateFlagsIDL)icEQIEJCN)?(IFB(IFCidTCBIFD*IFH)idtcbIFJ)pIFNidppcIG@:-IGFCM;(IKG(IKHidTCBIKI*IKM)idtcbIKO)pILCidlcpILE=ILI(ILK(ILLidTCBILM*IMA)idtcbIMC)pIMGiecutbIMI=IMN(IN@EA)ifnewcpINF;}INN
BNRP_releaseheap"7669 N {DB(3:iemark3;p3?iedata41[45CN]icEQ49ilBNRP_marker4<){DB(60iemark61p65iedata67[6;CM]icGE6?(72(73idTCB74*78)idtcb7:)p7>idlcp80){ilchoicepoint8:*96ibx97=99(9;ilchoicepoint9<*:8)iemark::p:>iedata;0[;4CM];(;?(<0idTCB<1*<5)idtcb<7)p<;ichp<===0ibx=2p=3ichp=5;(=<(==idTCB=>*>2)idtcb>4)p>8icce>:=>=ibx>?p?0idbce?2;(?:(?;idTCB?<*A@@)idtcbA@B)pA@FiccpA@H=A@KibxA@MpA@NidbcpAA@;(AAH(AAIidTCBAAJ*AAN)idtcbAB@)pABDiecutbABF=ABK(ABM(ABNidTCBABO*ACC)idtcbACE)pACIidlcpACK=ACO(ADAEA)ibxADGpADHidlcpADJ;}AEBAP(AEL(AEM(AENidTCBAEO*AFC)idtcbAFE)pAFIicteAFKicLTAFNiemarkAGApAGEiedataAGG[AGKCM]){EAieaddrAHJ;ierpopAIG(AIKEA,AJ@(AJB(AJCidTCBAJD*AJH)idtcbAJJ)pAJNicteAK@,AKBieaddrAKD);ierpopAKN(ALBEA,ALG(ALI(ALJidTCBALK*ALO)idtcbAMA)pAMEicteAMG,AMI*AMK(AMLEA*ANB)ieaddrAND);}ANN(AOB(AOCidTCBAOD*AOH)idtcbAOJ)pAONicteB@@=B@CiemarkB@EpB@IiedataB@K[B@OCM];(BAF(BAGidTCBBAH*BAL)idtcbBAN)pBBBiiprocnameBBD=BBMiemarkBBOpBCCiedataBCE[BCICM];DB(BDCiemarkBDDpBDHiedataBDJ[BDNCM]icEQBEB-BEECM){(BEN(BEOidTCBBF@*BFD)idtcbBFF)pBFJidppcBFL=BG@CN;(BGH(BGIidTCBBGJ*BGN)idtcbBH@)pBHDieppswBHFBJBHKimisolateFlagsBHN;}BKKDC{(BLI(BLJidTCBBLK*BLO)idtcbBMA)pBMEidppcBMG=BMKiemarkBMMpBNAiedataBNC[BNGCM];(C@@(C@AidTCBC@B*C@F)idtcbC@H)pC@LieppswC@N=CACiibodyModeCAE;}CDFixBNRP_cleanupTempSymbolsCDJ(CFA);iemarkCFGpCFKiedataCFM[CGACN]=CGECN;}CGLDCihfprintfCHF(CHMigstderrCHN,CIDs);}CLL
BNRP_execute"8706 N {idTCB32*36ibt37;EAihfreePtr40;nigresult4>;ibt59=5;(5=idTCB5>*62)idtcb64;ibt6:p6;ieppsw6==72iibodyMode74;ihfreePtr:3=:;ibt:=p:>ihfreePtr;0;ibt<5p<6idppc<8=<<ihfreePtr<>-=5CM;ibt>0p>1idppc>3=>7ihfreePtr>9;iepush?:(?>ieBYTE@OO,A@CihfreePtrA@E,A@LCM);iepushABL(AC@ieBYTEACA,ACEihfreePtrACG,ACNCM);iepushADH(ADLieBYTEADM,AEAihfreePtrAEC,AEJCM);iepushAFD(AFHieBYTEAFI,AFMihfreePtrAFO,AGFCM);iepushAHN(AIBieBYTEAIC,AIGihfreePtrAII,AJ@CM);iepushAJJ(AJNieBYTEAJO,AKCihfreePtrAKE,AKLCM);iepushAMC(AMGieBYTEAMH,AMLihfreePtrAMN,ANECM);idtcbANOpAOBieargsAOD[AOHCM]=AOLietermAON;DB(B@H(B@IibtB@JpB@KidlcpB@MicNEBAAibtBADpBAEigcpbaseBAG)BLBAO(BBB(BBC(BBDilchoicepointBBE*BCA)ibtBCCpBCDidlcpBCF)pBCJidclpBCLicEQBD@(BDCEA)&BDIipBNRP_markClauseBDJ)){(BMD(BMEilchoicepointBMF*BNB)ibtBNDpBNEidlcpBNG)pBNKicteBNM=BO@ibtBOBpBOCicteBOE;}BOKiqoldSigIntHandlerC@J=CAKiwBNRP_installSighandlerCAM(CCCigSIGINTCCD,CCJitBNRP_initSighandlerCCL(CDOimabortHandlerCE@));iqoldSigFpeHandlerCFA=CGBiwBNRP_installSighandlerCGD(CHJigSIGFPECHK,CIAitBNRP_initSighandlerCIC(CJFimarithHandlerCJG));igresultCL@=CLGilBNRP_RESUMECLI(CMDibtCME);iwBNRP_installSighandlerCNF(COLigSIGINTCOM,D@CiqoldSigIntHandlerD@D);iwBNRP_installSighandlerDCC(DDIigSIGFPEDDJ,DE@iqoldSigFpeHandlerDEA);ibtDHHpDHIieppswDHKBHDI@~DICimisolateFlagsDID;DB(DKB(DKCigresultDKDicEQDKKCN)BLDLA(DLD(DLEibtDLFpDLGidppcDLI+DLLCM)icEQDM@iqBNRP_markFailureDMC)){DB(DOB(DOCigresultDODicEQDOKCN)BLE@A(E@DibtE@EpE@FidppcE@HicEQE@LiqBNRP_markFailureE@O)){igresultEBM=ECDirOUTOFCHOICEPOINTSECF;ibtEDKpEDLieppswEDN=EECimisolateFlagsEEE|EFBigresultEFD;}EHLAL(EIEigresultEIF);}EJ@niqBNRP_executeOnceEKK(ELKiiBNRP_TCBELN*EMGidtcbEMH,EMKijBNRP_termEMNietermENH){idTCBEOA*EOEibtEOF;EAigopcodeEOO[F@ECM],F@HihfreePtrF@J;nigresultFAH;ibtFBC=FBE(FBGidTCBFBH*FBL)idtcbFBN;ibtFCDpFCEieppswFCG=FCLiibodyModeFCN;ihfreePtrFGB=FGJ(FGLEA)&FHBigopcodeFHC;ibtFIGpFIHidppcFIJ=FINihfreePtrFJ@-FJGCM;ibtFKBpFKCidppcFKE=FKIihfreePtrFKK;iepushFLL(FM@ieBYTEFMA,FMEihfreePtrFMG,FMNCM);iepushFON(G@BieBYTEG@C,G@GihfreePtrG@I,GA@CM);iepushGAJ(GANieBYTEGAO,GBCihfreePtrGBE,GBLCM);iepushGCF(GCJieBYTEGCK,GCOihfreePtrGDA,GDHCM);iepushGEL(GF@ieBYTEGFA,GFEihfreePtrGFG,GFNCM);iepushGGH(GGLieBYTEGGM,GHAihfreePtrGHC,GHJCM);iepushGJB(GJFieBYTEGJG,GJKihfreePtrGJM,GKDCM);iepushGKN(GLBieBYTEGLC,GLGihfreePtrGLI,GM@CM);iepushGNG(GNKieBYTEGNL,GO@ihfreePtrGOB,GOICM);idtcbH@CpH@FieargsH@H[H@LCM]=HA@ietermHAB;DB(HAL(HAMibtHANpHAOidlcpHBAicNEHBEibtHBHpHBIigcpbaseHBK)BLHCC(HCF(HCG(HCHilchoicepointHCI*HDE)ibtHDGpHDHidlcpHDJ)pHDNidclpHE@icEQHED(HEGEA)&HEMipBNRP_markClauseHEN)){(HNH(HNIilchoicepointHNJ*HOF)ibtHOHpHOIidlcpHOK)pHOOicteI@A=I@DibtI@FpI@GicteI@I;}I@OiqoldSigIntHandlerIAN=IBOiwBNRP_installSighandlerICA(IDGigSIGINTIDH,IDNitBNRP_initSighandlerIE@(IFCimabortHandlerIFD));iqoldSigFpeHandlerIGE=IHFiwBNRP_installSighandlerIHH(IINigSIGFPEIIO,IJEitBNRP_initSighandlerIJG(IKJimarithHandlerIKK));igresultIMD=IMKilBNRP_RESUMEIMM(INHibtINI);iwBNRP_installSighandlerIOJ(JA@igSIGINTJAA,JAGiqoldSigIntHandlerJAH);iwBNRP_installSighandlerJDG(JEMigSIGFPEJEN,JFDiqoldSigFpeHandlerJFE);DB(JJJ(JJKigresultJJLicEQJKCCN)BLJKI(JKL(JKMibtJKNpJKOidppcJLA+JLDCM)icEQJLHiqBNRP_markFailureJLK)){DB(JNJ(JNKigresultJNLicEQJOCCN)BLJOI(JOLibtJOMpJONidppcK@@icEQK@DiqBNRP_markFailureK@G)){igresultKBE=KBLirOUTOFCHOICEPOINTSKBN;ibtKDCpKDDieppswKDF=KDKimisolateFlagsKDM|KEJigresultKEL;}KHCDCibtKHMpKHNieppswKI@BJKIEimisolateFlagsKIH;AL(KLLigresultKLM);}KMGniqBNRP_executeNextKOB(L@BiiBNRP_TCBL@E*L@NidtcbL@O){idTCBLAG*LAKibtLAL;nigresultLBD;ibtLBO=LCA(LCCidTCBLCD*LCH)idtcbLCJ;DB(LDCibtLDDpLDEieppswLDG&LDLimisolateFlagsLDNicNELEKCN){ibtLFEpLFFieppswLFHBHLFM~LG@inisolateResultLGA;ibtLHBpLHCieppswLHEBJLHJirOUTOFCHOICEPOINTSLHM&LIOinisolateResultLJA;igresultLKB=LKIirOUTOFCHOICEPOINTSLKK;}LM@DC{iqoldSigIntHandlerLOE=M@FiwBNRP_installSighandlerM@H(MANigSIGINTMAO,MBEitBNRP_initSighandlerMBG(MCJimabortHandlerMCK));iqoldSigFpeHandlerMEK=MFLiwBNRP_installSighandlerMFN(MHDigSIGFPEMHE,MHKitBNRP_initSighandlerMHM(MJ@imarithHandlerMJA));igresultMLI=MM@ilBNRP_RESUMEMMB(MMMibtMMN);iwBNRP_installSighandlerMON(NADigSIGINTNAE,NAKiqoldSigIntHandlerNAL);iwBNRP_installSighandlerNEJ(NG@igSIGFPENGA,NGGiqoldSigFpeHandlerNGH);DB(NKM(NKNigresultNKOicEQNLFCN)BLNLL(NLO(NM@ibtNMApNMBidppcNMD+NMGCM)icEQNMKiqBNRP_markFailureNMN)){DB(NOM(NONigresultNOOicEQO@FCN)BLO@L(O@OibtOA@pOAAidppcOACicEQOAGiqBNRP_markFailureOAJ)){igresultOCI=OD@irOUTOFCHOICEPOINTSODB;ibtOEHpOEIieppswOEK=OF@imisolateFlagsOFB|OFOigresultOGA;}OII}OIMAL(OJFigresultOJG);}OKAijBNRP_termOLHimBNRP_makeVarOMB(OMNiiBNRP_TCBONA*ONJidtcbONK){EAidresOOH,OOKichpOOM;ichpQPPT=QPPW(QPPY(QPPZidTCBQPP[*QPP_)idtcbQPQQ)pQPQUichpQPQW;ijheaderLWAQPQ\(QPRUichpQPRV);ijheapcheckQPR\(QPSUCM);iepushQPVP(QPVTEA,QPVYichpQPV[,QPV]idresQPV_=QPWSilmakevartermQPWU(QPXPichpQPXQ));(QPXX(QPXYidTCBQPXZ*QPX^)idtcbQPYP)pQPYTichpQPYV=QPYYichpQPY[;AL(QPZVidresQPZW);}QPZ^ijBNRP_termQP\UiqBNRP_makeTailvarQP\_(QP]_iiBNRP_TCBQP^R*QP^[idtcbQP^\){EAidresQP_Y,QP_\ichpQP_^;ichpQQPU=QQPX(QQPZ(QQP[idTCBQQP\*QQQP)idtcbQQQR)pQQQVichpQQQX;ijheaderLWAQQQ](QQRVichpQQRW);ijheapcheckQQR](QQSVCM);iepushQQVQ(QQVUEA,QQVZichpQQV\,QQV^idresQQWP=QQWTiimaketermQQWV(QQW^ifTVTAGQQW_,QQXTichpQQXV));(QQX](QQX^idTCBQQX_*QQYS)idtcbQQYU)pQQYYichpQQY[=QQY^ichpQQZP;AL(QQZ[idresQQZ\);}QQ[SijBNRP_termQQ\ZiqBNRP_makeIntegerQQ]T(QQ^TiiBNRP_TCBQQ^W*QQ_PidtcbQQ_Q,QQ_TEAniblQRPP){AL(QRP\ihmakeintQRP](QRQT&QRQU(QRQV(QRQWidTCBQRQX*QRQ\)idtcbQRQ^)pQRRRichpQRRT,QRRViblQRRX));}QRR^ijBNRP_termQRTUioBNRP_makeFloatQRT_(QRU]iiBNRP_TCBQRVP*QRVYidtcbQRVZ,QRV]DJibdQRWW){icfpQRW]ibtQRXP;ibtQRXV=QRXXibdQRXZ;AL(QRYTijmakefloatQRYU(QRY^&QRY_(QRZP(QRZQidTCBQRZR*QRZV)idtcbQRZX)pQRZ\ichpQRZ^,QR[P&QR[RibtQR[S));}QR[YijBNRP_termQR]PipBNRP_makeSymbolQR]Z(QR^YiiBNRP_TCBQR^\*QR_UidtcbQR_V,QR_YDIc*QSPWibsQSPX){AL(QSQTiuBNRPLookupTempSymbolQSQU(QSRY(QSRZidTCBQSR[*QSR_)idtcbQSSQ,QSSTibsQSSV));}QSS\ijBNRP_termQSUSitBNRP_makePermSymbolQSU](QSWPDIc*QSW\ibsQSW]){AL(QSXYiuBNRPLookupPermSymbolQSXZ(QSY^ibsQSY_));}QSZUijBNRP_termQS]YinBNRP_makeTermQS^S(QS_PiiBNRP_TCBQS_S*QS_\idtcbQS_],QTPPDIc*QTP_ibsQTQQ){ijBNRP_termQTQWigresultQTRQ;DB(QTR_(QTSPigresultQTSQ=QTSXixBNRP_makeTermFromStringQTSZ(QTUQ(QTURidTCBQTUS*QTUW)idtcbQTUY,QTU\ibsQTU^))icEQQTVR(QTVUijBNRP_termQTVV)CN)AL(QTW[ipBNRP_makeSymbolQTW\(QTX[idtcbQTX\,QTX_ibsQTYQ));DCAL(QTZTigresultQTZU);}QTZ_imBNRP_BooleanQT^RirBNRP_termToStringQT^_(QUPPiiBNRP_TCBQUPR*QUP\idtcbQUP],QUQPijBNRP_termQUSRietermQUS],QUTQc*QUV]igbufferQUV^,QUWTEAigbuflenQUZQ){ALivBNRP_makeTermToStringQU[V(QU\[(QU\\idTCBQU\]*QU]Q)idtcbQU]S,QU]VietermQU]X,QU]\igbufferQU]^,QU^TigbuflenQU^V);}QU^_nipBNRP_newContextQVPZ(QVQYDIc*QVRUifname1QVRV,QVR[DIc*QVSXifname2QVSY){AL(QVTYioBNRPnewContextQVTZ(QVUXiuBNRPLookupPermSymbolQVUY(QVV]ifname1QVV^),QVWTiuBNRPLookupPermSymbolQVWV(QVXZifname2QVX[))?CN:ilOUTOFMEMORYQVYY);}QVZXninBNRP_loadFileQV\T(QV]QDIc*QV]_iifilenameQV^P){AL(QV_SiiloadFileQV_T(QV_\iifilenameQV_]));}QWPZiiBNRP_tagQWRQinBNRP_getValueQWRZ(QWSWijBNRP_termQWSZietermQWTT,QWTXilBNRP_resultQWT[*QWUWigresultQWUX){ijBNRP_termQWVSiblQWV];DB(QWWV(QWWWiblQWWX=QWWZietermQWW\)icEQQWXRCN)AL(QWX^imBNRP_invalidQWX_);AP(QWZUifisVARQWZV(QWZ[iblQWZ\)BKQWZ_ieisTVQW[R(QW[ViblQW[W)){EEEAicllQW\]=QW]P*QW]R(QW]SEA*QW]Y)(QW][igaddrofQW]\(QW^RiblQW^S));DB(QW^]iblQW^^icEQQW_PicllQW_S){(QXQY*QXQZigresultQXQ[).ietvalQXRS=QXRXiblQXRZ;AL(QXSV(QXSWiftagofQXSX(QXS]iblQXS^)icEQQXTQifTVTAGQXTT)?imBNRP_tailvarQXT]:iiBNRP_varQXU\);}QXVZiblQXV^=QXWPicllQXWR;}QXWXDB(QXW^iblQXW_icEQQXXQCN)AL(QXX]iiBNRP_endQXX^);DB(QXY]iblQXY^&QXZPCM){DB(QX\ZiblQX\[&QX\]CM){(QX_T*QX_UigresultQX_V).idsymQX_^.iesvalQYPR=QYPWignameofQYPY(QYP_iblQYQP);(QYQW*QYQXigresultQYQY).idsymQYRQ.ieorigQYRU=QYRZiblQYR\;AL(QYSXilBNRP_symbolQYSY);iferrorQYVW}QYWWDC{icliQYY\ibtQYY_;ibtQYZY.iblQYZ[=QYZ]iblQYZ_;(QY[U*QY[VigresultQY[W).ieivalQY[_=QY\TibtQY\V.ibiQY\X.ibbQY\Z;AL(QY]VimBNRP_integerQY]W);iferrorQZPS}QZQS}QZQWDC{DB(QZS_iblQZTP&QZTRCM){(QZVY*QZVZigresultQZV[).ietermQZWS.iffirstQZWX=QZW^iimaketermQZXP(QZXXifTVTAGQZXY,QZX^igaddrofQZYP(QZYViblQZYW));AL(QZZUijBNRP_listQZZV);iferrorQZ]P}QZ^PDC{EAibaQ[P[;icliQ[QQibtQ[QT;ijBNRP_termQ[QZibbQ[RT;ibaQ[R]=Q[R_igaddrofQ[SQ(Q[SWiblQ[SX);idgetQ[S_(Q[TREA,Q[TWibaQ[TY,Q[TZibtQ[T\.iblQ[T^);DB(Q[UXibtQ[UY.ibiQ[U[.ibaQ[U]icEQQ[U_inNUMBERIDshortQ[VR){DB(Q[WZibtQ[W[.ibiQ[W].ibbQ[W_icEQQ[XQikINTIDshortQ[XT){idgetQ[YW(Q[YZEA,Q[Y_ibaQ[ZQ,Q[ZR(Q[ZT*Q[ZUigresultQ[ZV).ieivalQ[Z^);AL(Q[\PimBNRP_integerQ[\Q);}Q[]UDC{iffpLWAQ[^W(Q[^\ibaQ[^]);(Q[_V*Q[_WigresultQ[_X).iefvalQ\PP=Q\PU*Q\PW(Q\PXicfpQ\PY*Q\P\)ibaQ\P^;AL(Q\Q\ikBNRP_floatQ\Q]);}Q\R_}Q\SUidgetQ\SZ(Q\S]EA,Q\TRibaQ\TT,Q\TUibbQ\TW);AP(Q\X^ifisVARQ\X_(Q\YTibbQ\YU)BKQ\YXieisTVQ\Y[(Q\Y_ibbQ\ZP)){EEEAicbbQ\[[=Q\[^*Q\\P(Q\\QEA*Q\\W)(Q\\YigaddrofQ\\Z(Q\]PibbQ\]Q));DB(Q\^RibbQ\^SicEQQ\^UicbbQ\^X)AB;ibbQ]QS=Q]QUicbbQ]QW;}Q]Q_(Q]RU*Q]RVigresultQ]RW).ietermQ]R_.iffirstQ]ST=Q]SZiimaketermQ]S\(Q]TTifTVTAGQ]TU,Q]TZibaQ]T\);(Q]US*Q]UTigresultQ]UU).ietermQ]U].imfunctor_termQ]VR=Q]V_ibbQ]WQ;DB(Q]YSifisVARQ]YT(Q]YYibbQ]YZ))(Q]ZT*Q]ZUigresultQ]ZV).ietermQ]Z^.ihfunctorQ][S=Q][[s;DC(Q]]P*Q]]QigresultQ]]R).ietermQ]]Z.ihfunctorQ]]_=Q]^WignameofQ]^Y(Q]^_ibbQ]_P);(Q^RY*Q^RZigresultQ^R[).ietermQ^SS.ifarityQ^SX=Q^S^ibtQ^TP.ibiQ^TR.ibbQ^TT+Q^TV(Q^TX(Q^TYibtQ^TZ.ibiQ^T\.ibbQ^T^icGTQ^UPCN)?-Q^UXCM:CM);AL(Q^VZioBNRP_structureQ^V[);iferrorQ^Y\}Q^Z\}Q^[P}Q^[SiiBNRP_tagQ^\ZiuBNRP_getIndexedValueQ^]S(Q^^WijBNRP_termQ^^ZietermQ^_T,Q^_XniipositionQ^__,Q_PWilBNRP_resultQ_PZ*Q_QVigresultQ_QW){ijBNRP_termQ_RRiblQ_R\,Q_R]icllQ_R_;iblQ_SU=Q_SWCN;igmemsetQ_S](Q_TSigresultQ_TT,Q_TZCN,Q_T]CG(Q_UUilBNRP_resultQ_UV));DB(Q_VY(Q_VZicllQ_V[=Q_V^iftagofQ_WP(Q_WUietermQ_WV))icEQQ_W]ijSTRUCTTAGQ_XP){DB(Q_YRiipositionQ_YSicLTQ_Y\CN)AL(Q_ZXimBNRP_invalidQ_ZY);ietermQ_[Z=Q_[_igaddrofQ_\Q(Q_\WietermQ_\X);idgetQ_]Q(Q_]TEA,Q_]YietermQ_][,Q_]_iblQ_^Q);idgetQ__Z(Q__]EA,RPPRietermRPPT,RPPXiblRPPZ);}RPRTDCDB(RPR_(RPSPicllRPSQicEQRPSTifTVTAGRPSW)BKRPS^(RPTQicllRPTRicEQRPTUihLISTTAGRPTX)){DB(RPUYiipositionRPUZicLERPVSCN)AL(RPV_imBNRP_invalidRPWP);ietermRPXQ=RPXVigaddrofRPXX(RPX^ietermRPX_);}RPYXDCAL(RPZYimBNRP_invalidRPZZ);AP(RP\PCFRP\QiipositionRP\SicGERP\\CN){idgetRP]V(RP]YEA,RP]^ietermRP^P,RP^TiblRP^V);AP(RQRPiftagofRQRQ(RQRViblRQRW)icEQRQRZifTVTAGRQR]){ietermRQSY=RQS^igaddrofRQTP(RQTViblRQTW);idgetRQT^(RQUQEA,RQUVietermRQUX,RQU\icllRQU^);DB(RQVYiblRQVZicEQRQV\icllRQV_){(RQYT*RQYUigresultRQYV).ietvalRQY^=RQZSicllRQZU;AL(RQ[S(RQ[TiipositionRQ[UicEQRQ[^CN)?imBNRP_tailvarRQ\V:imBNRP_invalidRQ]U);}RQ^XiblRQ^]=RQ^_icllRQ_Q;}RQ_XDB(RQ__iblRRPPicEQRRPRCN)AL(RRSV(RRSWiipositionRRSXicEQRRTQCN)?iiBNRP_endRRTY:imBNRP_invalidRRUT);}RRVUAP(RRV_iftagofRRWP(RRWUiblRRWV)icEQRRWYigVARTAGRRW\){EEEAicllRRYV=RRYYiiderefVARRRY[(RRZSiblRRZT);DB(RRZ]iblRRZ^icEQRR[PicllRR[S){(RR]W*RR]XigresultRR]Y).ietvalRR^Q=RR^ViblRR^X;AL(RR_TiiBNRP_varRR_U);}RSPSiblRSPW=RSPYicllRSP[;}RSQQDB(RSQZiblRSQ[&RSQ]CM){DB(RSTWiblRSTX&RSTZCM){(RSWQ*RSWRigresultRSWS).idsymRSW[.iesvalRSW_=RSXTignameofRSXV(RSX\iblRSX]);(RSYT*RSYUigresultRSYV).idsymRSY^.ieorigRSZR=RSZWiblRSZY;AL(RS[UilBNRP_symbolRS[V);iferrorRS^T}RS_TDC{icliRTQYibtRTQ\;ibtRTRV.iblRTRX=RTRZiblRTR\;(RTSR*RTSSigresultRTST).ieivalRTS\=RTTQibtRTTS.ibiRTTU.ibbRTTW;AL(RTUSimBNRP_integerRTUT);iferrorRTXP}RTYP}RTYTDC{DB(RT[\iblRT[]&RT[_CM){(RT^V*RT^WigresultRT^X).ietermRT_P.iffirstRT_U=RT_[iimaketermRT_](RUPUifTVTAGRUPV,RUP[igaddrofRUP](RUQSiblRUQT));AL(RURRijBNRP_listRURS);iferrorRUT]}RUU]DC{EAibaRUXX;icliRUX^ibtRUYQ;ijBNRP_termRUYWibbRUZQ;ibaRUZZ=RUZ\igaddrofRUZ^(RU[TiblRU[U);idgetRU[\(RU[_EA,RU\TibaRU\V,RU\WibtRU\Y.iblRU\[);DB(RU]UibtRU]V.ibiRU]X.ibaRU]ZicEQRU]\inNUMBERIDshortRU]_){DB(RU_WibtRU_X.ibiRU_Z.ibbRU_\icEQRU_^ikINTIDshortRVPQ){idgetRVQT(RVQWEA,RVQ\ibaRVQ^,RVQ_(RVRQ*RVRRigresultRVRS).ieivalRVR[);AL(RVS]imBNRP_integerRVS^);}RVURDC{iffpLWARVVT(RVVYibaRVVZ);(RVWS*RVWTigresultRVWU).iefvalRVW]=RVXR*RVXT(RVXUicfpRVXV*RVXY)ibaRVX[;AL(RVYYikBNRP_floatRVYZ);}RVZ\}RV[RidgetRV[W(RV[ZEA,RV[_ibaRV\Q,RV\RibbRV\T);AP(RV]QifisVARRV]R(RV]WibbRV]X)BKRV][ieisTVRV]^(RV^RibbRV^S)){EEEAicbbRV_^=RWPQ*RWPS(RWPTEA*RWPZ)(RWP\igaddrofRWP](RWQSibbRWQT));DB(RWRUibbRWRVicEQRWRXicbbRWR[)AB;ibbRWUV=RWUXicbbRWUZ;}RWVR(RWVX*RWVYigresultRWVZ).ietermRWWR.iffirstRWWW=RWW]iimaketermRWW_(RWXWifTVTAGRWXX,RWX]ibaRWX_);(RWYV*RWYWigresultRWYX).ietermRWZP.imfunctor_termRWZU=RW[RibbRW[T;DB(RW]VifisVARRW]W(RW]\ibbRW]]))(RW^W*RW^XigresultRW^Y).ietermRW_Q.ihfunctorRW_V=RW_^s;DC(RXQS*RXQTigresultRXQU).ietermRXQ].ihfunctorRXRR=RXRZignameofRXR\(RXSRibbRXSS);(RXV]*RXV^igresultRXV_).ietermRXWW.ifarityRXW\=RXXRibtRXXT.ibiRXXV.ibbRXXX+RXXZ(RXX\(RXX]ibtRXX^.ibiRXYP.ibbRXYRicGTRXYTCN)?-RXY\CM:CM);AL(RXZ^ioBNRP_structureRXZ_);iferrorRX^P}RX_P}RX_T}RX_WiiBNRP_tagRYP^irBNRP_getNextValueRYQW(RYRXijBNRP_termRYR[*RYSUietermRYSV,RYSZilBNRP_resultRYS]*RYTYigresultRYTZ){ijBNRP_termRYUUiblRYU_,RYVPicllRYVR;igmemsetRYVY(RYV_igresultRYWP,RYWVCN,RYWYCG(RYXQilBNRP_resultRYXR));DB(RYYUiftagofRYYV(RYY[*RYY\ietermRYY])icNERYZSifTVTAGRYZV)AL(RY[SimBNRP_invalidRY[T);*RY\TietermRY\U=RY\ZigaddrofRY\\(RY]R*RY]SietermRY]T);idgetRY]\(RY]_EA,RY^T*RY^VietermRY^W,RY^[iblRY^]);AP(RY_XiftagofRY_Y(RY_^iblRY__)icEQRZPRifTVTAGRZPU){*RZQPietermRZQQ=RZQVigaddrofRZQX(RZQ^iblRZQ_);idgetRZRU(RZRXEA,RZR]*RZR_ietermRZSP,RZSTicllRZSV);DB(RZTPiblRZTQicEQRZTSicllRZTV){(RZWY*RZWZigresultRZW[).ietvalRZXS=RZXXicllRZXZ;*RZYQietermRZYR=RZYWCN;AL(RZ\\imBNRP_tailvarRZ\]);}RZ]_iblRZ^S=RZ^UicllRZ^W;}RZ^]DB(RZ_SiblRZ_TicEQRZ_VCN){*R[PPietermR[PQ=R[PVCN;AL(R[S[iiBNRP_endR[S\);}R[TY*R[T\ietermR[T]=R[URiimaketermR[UT(R[U\ifTVTAGR[U],R[VRigaddrofR[VT(R[VZ*R[V[ietermR[V\));AP(R[W[iftagofR[W\(R[XQiblR[XR)icEQR[XUigVARTAGR[XX){EEEAicllR[ZR=R[ZUiiderefVARR[ZW(R[Z_iblR[[P);DB(R[[YiblR[[ZicEQR[[\icllR[[_){(R[^U*R[^VigresultR[^W).ietvalR[^_=R[_TiblR[_V;AL(R\PRiiBNRP_varR\PS);}R\QQiblR\QU=R\QWicllR\QY;}R\Q_DB(R\RUiblR\RV&R\RXCM){DB(R\URiblR\US&R\UUCM){(R\W\*R\W]igresultR\W^).idsymR\XV.iesvalR\XZ=R\X_ignameofR\YQ(R\YWiblR\YX);(R\Y_*R\ZPigresultR\ZQ).idsymR\ZY.ieorigR\Z]=R\[RiblR\[T;AL(R\\PilBNRP_symbolR\\Q);iferrorR\^_}R\__DC{icliR]RTibtR]RW;ibtR]SQ.iblR]SS=R]SUiblR]SW;(R]S]*R]S^igresultR]S_).ieivalR]TW=R]T\ibtR]T^.ibiR]UP.ibbR]UR;AL(R]U^imBNRP_integerR]U_);iferrorR]X[}R]Y[}R]Y_DC{DB(R]\WiblR]\X&R]\ZCM){(R]_Q*R]_RigresultR]_S).ietermR]_[.iffirstR^PP=R^PViimaketermR^PX(R^QPifTVTAGR^QQ,R^QVigaddrofR^QX(R^Q^iblR^Q_));AL(R^R]ijBNRP_listR^R^);iferrorR^UX}R^VXDC{EAibaR^YS;icliR^YYibtR^Y\;ijBNRP_termR^ZRibbR^Z\;ibaR^[U=R^[WigaddrofR^[Y(R^[_iblR^\P);idgetR^\W(R^\ZEA,R^\_ibaR^]Q,R^]RibtR^]T.iblR^]V);DB(R^^PibtR^^Q.ibiR^^S.ibaR^^UicEQR^^WinNUMBERIDshortR^^Z){DB(R_PRibtR_PS.ibiR_PU.ibbR_PWicEQR_PYikINTIDshortR_P\){idgetR_Q_(R_RREA,R_RWibaR_RY,R_RZ(R_R\*R_R]igresultR_R^).ieivalR_SV);AL(R_TXimBNRP_integerR_TY);}R_U]DC{iffpLWAR_V_(R_WTibaR_WU);(R_W^*R_W_igresultR_XP).iefvalR_XX=R_X]*R_X_(R_YPicfpR_YQ*R_YT)ibaR_YV;AL(R_ZTikBNRP_floatR_ZU);}R_[W}R_[]idgetR_\R(R_\UEA,R_\ZibaR_\\,R_\]ibbR_\_);AP(R_]]ifisVARR_]^(R_^SibbR_^T)BKR_^WieisTVR_^Z(R_^^ibbR_^_)){EEEAicbbSPPZ=SPP]*SPP_(SPQPEA*SPQV)(SPQXigaddrofSPQY(SPQ_ibbSPRP));DB(SPSQibbSPSRicEQSPSTicbbSPSW)AB;ibbSPVR=SPVTicbbSPVV;}SPV^(SPWT*SPWUigresultSPWV).ietermSPW^.iffirstSPXS=SPXYiimaketermSPX[(SPYSifTVTAGSPYT,SPYYibaSPY[);(SPZR*SPZSigresultSPZT).ietermSPZ\.imfunctor_termSP[Q=SP[^ibbSP\P;DB(SP^RifisVARSP^S(SP^XibbSP^Y))(SP_S*SP_TigresultSP_U).ietermSP_].ihfunctorSQPR=SQPZs;DC(SQQ_*SQRPigresultSQRQ).ietermSQRY.ihfunctorSQR^=SQSVignameofSQSX(SQS^ibbSQS_);(SQWY*SQWZigresultSQW[).ietermSQXS.ifaritySQXX=SQX^ibtSQYP.ibiSQYR.ibbSQYT+SQYV(SQYX(SQYYibtSQYZ.ibiSQY\.ibbSQY^icGTSQZPCN)?-SQZXCM:CM);AL(SQ[ZioBNRP_structureSQ[[);iferrorSQ^\}SQ_\}SRPP}SRPSijBNRP_termSRQZitBNRP_getIndexedTermSRRT(SRSWijBNRP_termSRSZietermSRTT,SRTXniipositionSRT_){ijBNRP_termSRU\iblSRVV,SRVWicllSRVY;iblSRV_=SRWQCN;DB(SRWZ(SRW[icllSRW\=SRW_iftagofSRXQ(SRXVietermSRXW))icEQSRX^ijSTRUCTTAGSRYQ){DB(SRZSiipositionSRZTicLTSRZ]CN)AL(SR[YCN);ietermSR\P=SR\UigaddrofSR\W(SR\]ietermSR\^);idgetSR]W(SR]ZEA,SR]_ietermSR^Q,SR^UiblSR^W);idgetSSPP(SSPSEA,SSPXietermSSPZ,SSP^iblSSQP);}SSRZDCDB(SSSU(SSSVicllSSSWicEQSSSZifTVTAGSSS])BKSSTT(SSTWicllSSTXicEQSST[ihLISTTAGSST^)){DB(SSU_iipositionSSVPicLESSVYCN)AL(SSWUCN);ietermSSW\=SSXQigaddrofSSXS(SSXYietermSSXZ);}SSYSDCAL(SSZTCN);AP(SS[PCFSS[QiipositionSS[SicGESS[\CN){idgetSS\V(SS\YEA,SS\^ietermSS]P,SS]TiblSS]V);AP(STQPiftagofSTQQ(STQViblSTQW)icEQSTQZifTVTAGSTQ]){ietermSTRY=STR^igaddrofSTSP(STSViblSTSW);idgetSTS^(STTQEA,STTVietermSTTX,STT\icllSTT^);DB(STUYiblSTUZicEQSTU\icllSTU_)AL(STX[(STX\iipositionSTX]icEQSTYVCN)?iblSTY^:CN);iblSTZY=STZ[icllSTZ];}ST[TDB(ST[[iblST[\icEQST[^CN)AL(ST\ZCN);}ST_VAP(SUPPiftagofSUPQ(SUPViblSUPW)icEQSUPZigVARTAGSUP]){EEEAicllSURW=SURZiiderefVARSUR\(SUSTiblSUSU);DB(SUS^iblSUS_icEQSUTQicllSUTT)AB;iblSUV[=SUV]icllSUV_;}SUWUAL(SUW^iblSUW_);}SUXTijBNRP_termSUY[iqBNRP_getNextTermSUZU(SU[UijBNRP_termSU[X*SU\RietermSU\S){ijBNRP_termSU\\iblSU]V,SU]WicllSU]Y;DB(SU^SiftagofSU^T(SU^Y*SU^ZietermSU^[)icNESU_QifTVTAGSU_T)AL(SVPQCN);*SVPWietermSVPX=SVP]igaddrofSVP_(SVQU*SVQVietermSVQW);idgetSVQ_(SVRREA,SVRW*SVRYietermSVRZ,SVR^iblSVSP);AP(SVS[iftagofSVS\(SVTQiblSVTR)icEQSVTUifTVTAGSVTX){*SVUSietermSVUT=SVUYigaddrofSVU[(SVVQiblSVVR);idgetSVVX(SVV[EA,SVWP*SVWRietermSVWS,SVWWicllSVWY);DB(SVXSiblSVXTicEQSVXVicllSVXY){*SVZ[ietermSVZ\=SV[QCN;AL(SV^WicllSV^X);}SWPUiblSWPY=SWP[icllSWP];}SWQSDB(SWQYiblSWQZicEQSWQ\CN){*SWTQietermSWTR=SWTWCN;AL(SWW]CN);}SWY[*SWY^ietermSWY_=SWZTiimaketermSWZV(SWZ^ifTVTAGSWZ_,SW[TigaddrofSW[V(SW[\*SW[]ietermSW[^));AP(SW\]iftagofSW\^(SW]SiblSW]T)icEQSW]WigVARTAGSW]Z){EEEAicllSW_T=SW_WiiderefVARSW_Y(SXPQiblSXPR);DB(SXP[iblSXP\icEQSXP^icllSXQQ)AB;iblSXS[=SXS]icllSXS_;}SXTUAL(SXT^iblSXT_);}SXUTijBNRP_termSXV[inBNRP_makeListSXWU(SXXRiiBNRP_TCBSXXU*SXX^idtcbSXX_,SXYREAifaritySXYZ,SXY_FB){EAidresSX]\,SX]_ichpSX^Q;ihva_listSX^VicapSX^^;ichpSX_U=SX_X(SX_Z(SX_[idTCBSX_\*SYPP)idtcbSYPR)pSYPVichpSYPX;ijheaderLWASYP](SYQVichpSYQW);ijheapcheckSYQ](SYRVifaritySYRW+SYR]CM);idresSYVQ=SYVUiimaketermSYVW(SYV_ihLISTTAGSYWP,SYWWichpSYWY);iiva_startSYW_(SYXWicapSYXX,SYXZifaritySYX\);AP(SYY[ifaritySYY\icGTSYZRCN){iepushSYZ\(SY[PijBNRP_termSY[Q,SY[ZichpSY[\,SY[^igva_argSY\P(SY\VicapSY\W,SY\YijBNRP_termSY\[));CFSY]ZifaritySY]\;}SY^Uigva_endSY^X(SY^^icapSY^_);iepushSY_U(SY_YEA,SY_^ichpSZPP,SZPRCM);(SZPZ(SZP[idTCBSZP\*SZQP)idtcbSZQR)pSZQVichpSZQX=SZQ[ichpSZQ];AL(SZRXidresSZRY);}SZSPijBNRP_termSZTWisBNRP_makeStructureSZUQ(SZVSiiBNRP_TCBSZVV*SZV_idtcbSZWP,SZWSDIc*SZXQienameSZXR,SZXVEAifaritySZX^,SZYSFB){EAifstartSZ]P,SZ]UichpSZ]W;ihva_listSZ]\icapSZ^T;icliSZ^YigheaderSZ^\;ijBNRP_termSZ_UibtSZ__,S[PPibaS[PR;DB(S[PZienameS[P[icEQS[QPieNULLS[QS)ibaS[Q^=S[RPimBNRP_makeVarS[RR(S[R^idtcbS[R_);DCibaS[TQ=S[TSiuBNRPLookupTempSymbolS[TU(S[UY(S[UZidTCBS[U[*S[U_)idtcbS[VQ,S[VTienameS[VV);ichpS[V^=S[WQ(S[WS(S[WTidTCBS[WU*S[WY)idtcbS[W[)pS[W_ichpS[XQ;ijheaderLWAS[XV(S[X_ichpS[YP);ijheapcheckS[YV(S[Y_ifarityS[ZP+S[ZVCM);ifstartS[]X=S[]^ichpS[^P;igheaderS[^U.iblS[^\=S[^^imSTRUCTHEADERS[_P+S[_]CM;iepushS\RR(S\RVEA,S\R[ichpS\R],S\R_igheaderS\SQ.iblS\SX);iepushS\S](S\TQijBNRP_termS\TR,S\T[ichpS\T],S\T_ibaS\UQ);iiva_startS\UV(S\U^icapS\U_,S\VQifarityS\VS);AP(S\WRifarityS\WSicGTS\WYCN){ibtS\XS=S\XUigva_argS\XW(S\X]icapS\X^,S\YPijBNRP_termS\YR);iepushS\ZP(S\ZTijBNRP_termS\ZU,S\Z^ichpS\[P,S\[RibtS\[T);CES\[ZigheaderS\[\.ibiS\\S.ibbS\\U;CFS\\ZifarityS\\\;}S\]Uigva_endS\]X(S\]^icapS\]_);iepushS\^U(S\^YEA,S\^^ichpS\_P,S\_RCM);DB(S\_]iftagofS\_^(S]PSibtS]PT)icEQS]PWifTVTAGS]PZ)igheaderS]QQ.ibiS]QX.ibbS]QZ=S]Q\-S]Q^igheaderS]Q_.ibiS]RV.ibbS]RX;*S]R\(S]R]EA*S]SS)ifstartS]SU=S]S[igheaderS]S].iblS]TT;(S]VX(S]VYidTCBS]VZ*S]V^)idtcbS]WP)pS]WTichpS]WV=S]WYichpS]W[;AL(S]XViimaketermS]XW(S]X_ijSTRUCTTAGS]YP,S]YYifstartS]Y[));}S]ZUijBNRP_termS][\ioBNRP_startListS]\V(S]]TiiBNRP_TCBS]]W*S]^PidtcbS]^Q){EAichpS]^^,S]_PidresS]_R;ichpS]_Z=S]_](S]__(S^PPidTCBS^PQ*S^PU)idtcbS^PW)pS^P[ichpS^P];ijheaderLWAS^QR(S^Q[ichpS^Q\);ijheapcheckS^RR(S^R[CM);idresS^U]=S^VQiimaketermS^VS(S^V[ihLISTTAGS^V\,S^WSichpS^WU);iepushS^W[(S^W_EA,S^XTichpS^XV,S^XXCM);(S^YP(S^YQidTCBS^YR*S^YV)idtcbS^YX)pS^Y\ichpS^Y^=S^ZQichpS^ZS;AL(S^Z^idresS^Z_);}S^[VijBNRP_termS^\]itBNRP_startStructureS^]W(S^^ZiiBNRP_TCBS^^]*S^_VidtcbS^_W,S^_ZDIc*S_PXienameS_PY){EAidresS_QW,S_QZichpS_Q\;ijBNRP_termS_RQibaS_R[;DB(S_SSienameS_STicEQS_SYieNULLS_S\)ibaS_TW=S_TYimBNRP_makeVarS_T[(S_UWidtcbS_UX);DCibaS_V[=S_V]iuBNRPLookupTempSymbolS_V_(S_XS(S_XTidTCBS_XU*S_XY)idtcbS_X[,S_X^ienameS_YP);ichpS_YX=S_Y[(S_Y](S_Y^idTCBS_Y_*S_ZS)idtcbS_ZU)pS_ZYichpS_Z[;ijheaderLWAS_[P(S_[YichpS_[Z);ijheapcheckS_\P(S_\YCM);idresS__Y=S__]iimaketermS___(TPPWijSTRUCTTAGTPPX,TPQQichpTPQS);iepushTPQY(TPQ]EA,TPRRichpTPRT,TPRVimSTRUCTHEADERTPRX+TPSUCM);iepushTPU\(TPVPijBNRP_termTPVQ,TPVZichpTPV\,TPV^ibaTPWP);iepushTPWU(TPWYEA,TPW^ichpTPXP,TPXRCM);(TPXZ(TPX[idTCBTPX\*TPYP)idtcbTPYR)pTPYVichpTPYX=TPY[ichpTPY];AL(TPZXidresTPZY);}TP[PijBNRP_termTP\WixBNRP_startStructureAtomTP]Q(TP^XiiBNRP_TCBTQQT*TQQ]idtcbTQQ^,TQRQijBNRP_termTQR[ibaTQSU){EAidresTQTW,TQTZichpTQT\;DB(TQUT(TQUUiftagofTQUV(TQU[ibaTQU\)icNETQU_ijSYMBOLTAGTQVR)BLTQV](TQWPiftagofTQWQ(TQWVibaTQWW)icNETQWZigVARTAGTQW]))AL(TQX\(TQX]ijBNRP_termTQX^)ieNULLTQYX);ichpTQZW=TQZZ(TQZ\(TQZ]idTCBTQZ^*TQ[R)idtcbTQ[T)pTQ[XichpTQ[Z;ijheaderLWATQ\V(TQ\_ichpTQ]P);ijheapcheckTQ]](TQ^VCM);idresTRQ]=TRRQiimaketermTRRS(TRR[ijSTRUCTTAGTRR\,TRSUichpTRSW);iepushTRTT(TRTXEA,TRT]ichpTRT_,TRUQimSTRUCTHEADERTRUS+TRVPCM);iepushTRX](TRYQijBNRP_termTRYR,TRY[ichpTRY],TRY_ibaTRZQ);iepushTRZ](TR[QEA,TR[VichpTR[X,TR[ZCM);(TR\Y(TR\ZidTCBTR\[*TR\_)idtcbTR]Q)pTR]UichpTR]W=TR]ZichpTR]\;AL(TR^^idresTR^_);}TR_]imBNRP_BooleanTSQTimBNRP_addTermTSRQ(TSR]iiBNRP_TCBTSSP*TSSYidtcbTSSZ,TSS]ijBNRP_termTSTPietermTSTZ,TST^ijBNRP_termTSURihnewTermTSU\){EAichpTSV],TSV_ifstartTSWQ,TSWV*TSWXieaddrTSWY=TSW^ieNULLTSXP;icliTSXWigheaderTSXZ;ijBNRP_termTSYSibtTSY];imBNRP_BooleanTSZQiffixupTSZ^=TS[TifFALSETS[V;ifstartTS\P=TS\VigaddrofTS\X(TS\^ietermTS\_);DB(TS]Z(TS][ibtTS]\=TS]^iftagofTS^P(TS^UietermTS^V))icEQTS^]ijSTRUCTTAGTS_P){igheaderTS__.iblTTPV=TTPX*TTPZ(TTP[EA*TTQQ)ifstartTTQS;DB(TTQ_igheaderTTRP.ibiTTRW.ibbTTRYicGETTR[CN){CETTSVigheaderTTSX.ibiTTS_.ibbTTTQ;ieaddrTTTW=TTT\(TTT^EA*TTUT)ifstartTTUV;*TTVPieaddrTTVQ=TTVVigheaderTTVX.iblTTV_;ifstartTTWUBDTTW[(TTW^igheaderTTW_.ibiTTXV.ibbTTXX*TTXZCG(TTYRijBNRP_termTTYS));}TT[WDC{ifstartTT_UBETT_[(TT_^igheaderTT__.ibiTUPV.ibbTUPX*TUPZCG(TUQRijBNRP_termTUQS));}TUSW}TUS[DCDB(TUTVibtTUTWicNETUTYihLISTTAGTUT\)AL(TUU]ifFALSETUU^);AP(TUV_(TUWPibtTUWQ=TUWS*TUWU(TUWVEA*TUW\)ifstartTUW^)icNETUXUCN){DB(TUYRiftagofTUYS(TUYXibtTUYY)icEQTUY\ifTVTAGTUY_){ifstartTUZ[=TU[QigaddrofTU[S(TU[YibtTU[Z);DB(TU\T*TU\U(TU\VEA*TU\\)ifstartTU\^icEQTU]TibtTU]W)AL(TU^PifFALSETU^Q);}TU__DCifstartTVP[BDTVQQCG(TVQZijBNRP_termTVQ[);}TVRYDB(TVSRiftagofTVSS(TVSXihnewTermTVSY)icEQTVTRifTVTAGTVTU){*TVUP(TVUQEA*TVUW)ifstartTVUY=TVU_ihnewTermTVVQ;iffixupTVV\=TVWR(TVWTieaddrTVWUicNETVWZieNULLTVW]);}TVXVDC{ichpTV]P=TV]S(TV]U(TV]VidTCBTV]W*TV][)idtcbTV]])pTV^QichpTV^S;ilconstantLWATV^Y(TV_TichpTV_U);ijheapcheckTV_\(TWPUCM);DB(TWSYifstartTWSZicEQTWTPichpTWTS-TWTUCG(TWT\ijBNRP_termTWT])){*TWU^(TWU_EA*TWVU)ifstartTWVW=TWV]ihnewTermTWV_;}TWW[DC{*TWXY(TWXZEA*TWYP)ifstartTWYR=TWYXiimaketermTWYZ(TWZRifTVTAGTWZS,TWZXichpTWZZ);iffixupTW[R=TW[X(TW[ZieaddrTW[[icNETW\PieNULLTW\S);iepushTW\](TW]QEA,TW]VichpTW]X,TW]ZihnewTermTW]\);}TW^YiepushTW^](TW_QEA,TW_VichpTW_X,TW_ZCM);(TXPS(TXPTidTCBTXPU*TXPY)idtcbTXP[)pTXP_ichpTXQQ=TXQTichpTXQV;}TXQ\DB(TXRRiffixupTXRS){igheaderTXR^.ibiTXSU.ibbTXSW=TXSY-TXS[igheaderTXS\.ibiTXTS.ibbTXTU;*TXTZieaddrTXT[=TXUPigheaderTXUR.iblTXUY;}TXU^AL(TXVWieTRUETXVX);}TXWPijBNRP_termTXXWitBNRP_buildStructureTXYQ(TXZTiiBNRP_TCBTXZW*TX[QidtcbTX[R,TX[UDIc*TX\XienameTX\Y,TX\]EAifarityTYPY,TYP^ijBNRP_termTYTV*TYUPiftermsTYUQ){ijBNRP_termTYYPibaTYYZ;EAichpTY^R;EAifstartTZRZ;icliTZVUigheaderTZV_;nibiTZ[W;DB(TZ_ZifarityTZ_[icLTT[PQCN)ifarityT[P_=T[QUCN;DB(T[U_ienameT[VPicEQT[VUieNULLT[VX)ibaT[WP=T[WRimBNRP_makeVarT[WT(T[XPidtcbT[XQ);DCibaT[YT=T[YViuBNRPLookupTempSymbolT[YX(T[Z\(T[Z]idTCBT[Z^*T[[R)idtcbT[[T,T[[WienameT[[Y);ichpT[^Q=T[^T(T[^V(T[^WidTCBT[^X*T[^\)idtcbT[^^)pT[_RichpT[_T;ijheaderLWAT\R](T\SVichpT\SW);ijheapcheckT\WY(T\XRifarityT\XS+T\XYCM);ifstartT\\V=T\\\ichpT\\^;igheaderT]QR.iblT]QY=T]Q[imSTRUCTHEADERT]Q]+T]RZCM+T]R^ifarityT]SP;iepushT]U^(T]VREA,T]VWichpT]VY,T]V[igheaderT]V].iblT]WT);iepushT]Z[(T]Z_ijBNRP_termT][P,T][YichpT][[,T][]ibaT][_);AH(T]_^ibiT]__=T^PPCN;ibiT^PT<T^PUifarityT^PV;ibiT^P]CET^P^){iepushT^Q\(T^RPijBNRP_termT^RQ,T^RZichpT^R\,T^R^iftermsT^SP[T^SUibiT^SV]);}T^VWiepushT^VZ(T^V^EA,T^WSichpT^WU,T^WWCM);DB(T^[^ifarityT^[_){DB(T^]SiftagofT^]T(T^]YiftermsT^]Z[T^]_ifarityT^^P-T^^UCM])icEQT^^ZifTVTAGT^^]){igheaderT_RT.ibiT_R[.ibbT_R]=T_R_-T_SQigheaderT_SR.ibiT_SY.ibbT_S[;*T_TZ(T_T[EA*T_UQ)ifstartT_US=T_UYigheaderT_U[.iblT_VR;}T_YV}T_Y\(T_Z\(T_Z]idTCBT_Z^*T_[R)idtcbT_[T)pT_[XichpT_[Z=T_[]ichpT_[_;AL(T___iimaketermUPPP(UPPXijSTRUCTTAGUPPY,UPQRifstartUPQT));}UPQ]ijBNRP_termUPSTioBNRP_buildListUPS^(UPT\iiBNRP_TCBUPT_*UPUYidtcbUPUZ,UPU]EAifarityUPZW,UPZ\ijBNRP_termUP^\*UP_ViftermsUP_W){EAichpUQTX;ijBNRP_termUQX^ihlistermUQYX;nibiUQ^X;DB(UQ_SifarityUQ_TicLTUQ_ZCN)ifarityURPX=URP^CN;ichpURUR=URUU(URUW(URUXidTCBURUY*URU])idtcbURU_)pURVSichpURVU;ijheaderLWAURZS(URZ\ichpURZ]);ijheapcheckUR_T(UR_]ifarityUR_^+USPTCM);ihlistermUSTU=UST]iimaketermUST_(USUWihLISTTAGUSUX,USU_ichpUSVQ);AH(USY[ibiUSY\=USY]CN;ibiUSZQ<USZRifarityUSZS;ibiUSZZCEUSZ[){iepushUS[S(US[WijBNRP_termUS[X,US\QichpUS\S,US\UiftermsUS\W[US\\ibiUS\]]);}UTPSiepushUTPV(UTPZEA,UTP_ichpUTQQ,UTQSCM);(UTUX(UTUYidTCBUTUZ*UTU^)idtcbUTVP)pUTVTichpUTVV=UTVYichpUTV[;AL(UTZ_ihlistermUT[P);}UT[ZEPisBNRP_primitiveNameUT]V(UT^XiiBNRP_TCBUT^Y*UT_RidtcbUT_S,UT_Vc*UT_]iknameBufferUT__){DB(UUUP(UUUQ(UUURidTCBUUUS*UUUW)idtcbUUUY)pUUU]iiprocnameUUU_icEQUUVXCN)iknameBufferUUWP[UUWZCN]=UUW^DA;DCigstrcpyUUYS(UUYYiknameBufferUUYZ,UUZTignameofUUZV(UUZ\(UUZ](UUZ^idTCBUUZ_*UU[S)idtcbUU[U)pUU[YiiprocnameUU[[));}UU\WimBNRP_BooleanUU]^ipBNRP_listLengthUU^[(UU_ZijBNRP_termUU_[ielistUVPU,UVPYEA*UVQPiglengthUVQR){EAiblUVRT=UVRVielistUVRX;EA*UVSVienextUVSX;EAiesizeUVTV=UVTZCN;AP(UVWSifisVARUVWT(UVWYiblUVWZ)BKUVW]ieisTVUVXP(UVXTiblUVXU)){EEEAicllUVZR=UVZU*UVZW(UVZXEA*UVZ^)(UV[PigaddrofUV[Q(UV[WiblUV[X));DB(UV\ViblUV\WicEQUV\YicllUV\\)AL(UV]XifFALSEUV]Y);iblUV^W=UV^YicllUV^[;}UV_RDB(UWRZiftagofUWR[(UWSPiblUWSQ)icNEUWSTihLISTTAGUWSW)AL(UWT\ifFALSEUWT]);ienextUWWV=UWW[(UWW]EA*UWXS)igaddrofUWXU(UWX[iblUWX\);AP(UW\Z*UW\[ienextUW\\icNEUW]QCN){iesizeUW^RCEUW^V;AP(UXQ\iftagofUXQ](UXRR*UXRSienextUXRT)BMUXRZifTVTAGUXR]){iblUXS^=UXTQigaddrofUXTS(UXTY*UXTZienextUXT[);DB(UXUV(UXUWEA)ienextUXU]BMUXVRiblUXVU){*UXYXiglengthUXYY=UXZPCN-UXZSiesizeUXZT;AL(UX[UieTRUEUX[V);}UX[_ienextUX\S=UX\X(UX\ZEA*UX]P)iblUX]R;}UX][CEUX^SienextUX^U;}UX^^*UX_TiglengthUX_U=UX_\iesizeUX_^;AL(UYP]ieTRUEUYP^);}UYQUDLimBNRP_BooleanUYSTimhandleFileIOUYTQ(UYT]EFiiselectorUYUT,UYU\EAijprintFileUYVS,UYV\FB);DLimBNRP_BooleanUYW[iqBNRP_printQuotesUYXX;DLimBNRP_BooleanUYZQiqBNRP_printCommasUYZ^;DLimBNRP_BooleanUY\WiqBNRP_printBlanksUY]T;DLimBNRP_BooleanUY^]itBNRP_printIntervalsUY_Z;DLEAipBNRP_printCountUZQ[;DLihjmp_bufUZSSinBNRP_printEnvUZS[;EPinBNRP_dumpTermUZUP(UZU]ieFILEUZU^*UZVSiefileUZVT,UZVXijBNRP_termUZVZietermUZWT){EAigresultUZXT=UZX[CN;ihclearAMUZ[T(UZ[[);ioBNRP_fileIndexUZ]^=UZ^](UZ^_EA)iefileUZ_U;ioBNRP_printProcUZ_^=U[P]imhandleFileIOU[P_;ipBNRP_printCountU[RP=U[SPCN;inBNRP_printLenU[SX=U[TVipBNRP_getMaxLongU[TX(U[UW);iqBNRP_printQuotesU[XU=U[YVieTRUEU[YX;iqBNRP_printCommasU[ZQ=U[[RifFALSEU[[T;iqBNRP_printBlanksU[[^=U[\_ifFALSEU[]Q;itBNRP_printIntervalsU[][=U[^_ifFALSEU[_Q;DB(U\QYigresultU\QZ=U\RQigsetjmpU\RS(U\RYinBNRP_printEnvU\RZ)){AL;}U\VZirBNRP_displayValueU\XZ(U\Y[ietermU\Y\,U\ZPCM,U\ZSCM);(U\\XEP)(U\\^*U\\_ioBNRP_printProcU\]P)(U\]_ijFLUSHFILEU\^P,U\^YioBNRP_fileIndexU\^[);igfreeAMU]QR(U]QX);AL;}U]RX