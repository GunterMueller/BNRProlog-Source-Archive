
sigPipeHandler"8197 N {igprintf5>(64s);}97
ensureBufferSize"8557 N {iiTSBuffer38*40iknewBufferP42;DB(56*57ihbufferP58BM60CNBK65(68*69ihbufferP6:)p72ikbufferSize74<7?iesize81){iknewBufferP;>=<9(<;iiTSBuffer<<*=4)imBNRP_realloc=7(>3*>4ihbufferP>5,><CG(?4iiTSBuffer?5)+@OOiesizeA@A);DB(A@LiknewBufferPA@MBMAAHCN)ALifFALSEABJ;DB(ACE*ACFihbufferPACGBMACOCN)iknewBufferPADJpAEDiidataSizeAEF=AEOCN;*AHEihbufferPAHF=AHNiknewBufferPAI@;(AIM*AINihbufferPAIO)pAJGikbufferSizeAJI=AKDiesizeAKF;}AL@ALieTRUEALM;}AMC
BNRP_GetNetScratchBuffer"9178 N {EHiiTSBuffer3;*44inscratchBuffer45=53CN;DB(79iqensureBufferSize7:(8:&8;inscratchBuffer8<,99imrequiredSize9;)){inscratchBuffer:=p;:iidataSize;<=<5CN;ALinscratchBuffer=2;}>5DCALCN;}?7
getSocketBufferP"9843 N {nihnewHigh27;iiTSBuffer34*3<*3=iknewBuffers3?;nibi53;DB(99igsocket9:>:1itpHighTSBufferNumber:3){ihnewHigh;;=<3igsocket<5+<<ilkBufferSlop<>;iknewBuffers=<=>7(>9iiTSBuffer>:*?3*?4)imBNRP_realloc?7(A@CikpTSBuffersA@D,A@NCG(AAFiiTSBufferAAG*AAO)*ABBihnewHighABD);DB(ACBiknewBuffersACCBMACNCN)ALCN;ikpTSBuffersAED=AEOiknewBuffersAFA;AH(AGBibiAGC=AGEitpHighTSBufferNumberAGG;ibiAHL<AHNihnewHighAI@;ibiAIICEAIJ)ikpTSBuffersAJC[AJMibiAJN]=AKACN;itpHighTSBufferNumberAKG=ALKihnewHighALM;}AMJAL&ANG(ANHikpTSBuffersANI[AOCigsocketAOD-AOKCM]);}B@B
resizeSocketBuffer"10557 N {EAikbuffersize41;nigoptlen88;igoptlen<4=<;CG(=3ikbuffersize=4);DB(>8ikgetsockopt>9(?3igsocket?4,?:ikSOL_SOCKET?<,A@FijSO_SNDBUFA@H,AAA(AACihoptValTAAD*AAL)&AANikbuffersizeAAO,ABI(ABKiloptValSizeTABL*ACH)&ACJigoptlenACK)icNEADCCN)ikbuffersizeADJ=AEEimMAX_MSG_SIZEAEG;DB(AIIikbuffersizeAIJicLEAJECN)ikbuffersizeAJL=AKGimMAX_MSG_SIZEAKI;ikbuffersizeALKBDAMFCM;iqensureBufferSizeBAC(BBCihbufferPBBD,BBKikbuffersizeBBM);}BCJ
BNRP_GetSocketBuffer"11258 N {iiTSBuffer27*2?*30ihbufferP32=3:iqgetSocketBufferP3<(4<igsocket4=);DB(62ihbufferP63BM6;CN)ALCN;DB(83*84ihbufferP85BM8=CN)isresizeSocketBuffer94(:6igsocket:7,:=ihbufferP:?);AL*<4ihbufferP<5;}<>
BNRP_closesocket"11483 N {EAicfd26;DB(31idtcb32p35ihnumargs37icNE3?CM)AL(4;ifFALSE4<);DB(5:iicheckArg5;(63idtcb64p67ieargs69[6=CM],70&71icfd72)icNE76ieINTT79)AL(85ifFALSE86);DB(91!92iiFD_ISSET93(9;icfd9<,9>&9?ihBNRPfds:0))AL(;0ifFALSE;1);DB(;<icfd;=icLT<0CM)AL(<<ifFALSE<=);AG{}?>AP(A@F(A@GifcloseA@H(A@MicfdA@N)icEQAAB-AAECM)BLAAI(AALiferrnoAAMicEQABCifEINTRABF));igFD_CLRACA(ACGicfdACH,ACJ&ACKihBNRPfdsACL);igFD_CLRADG(ADMicfdADN,AE@&AEAiqBNRPconnectedFdsAEB);ilBNRPfdCountAFICFAGE;DB(AHAilBNRPfdCountAHBicLEAHNCN){ilBNRPfdCountAIN=AJJCN;isBNRPnetworkUseableAKG=ALJifFALSEALL;}AMGDB(BA@icfdBAABOBADitpHighTSBufferNumberBAG){iiTSBufferBBO*BCG*BCHihbufferPBCJ=BDBiqgetSocketBufferPBDD(BEDicfdBEE);DB(BEN*BEOihbufferPBF@){ijBNRP_freeBG@(BGI*BGJihbufferPBGK);*BHJihbufferPBHK=BICCN;}BII}BIOAL(BJLieTRUEBJM);}BKD
BNRP_setsocketopt"12362 N {EAigsocket27;EAigoption38;EAifvalue49;EAiferror59=5?CN;DB(85idtcb86p89ihnumargs8;icNE93CM)AL(9?ifFALSE:0);DB(<9iicheckArg<:(=2idtcb=3p=6ieargs=8[=<CM],=?&>0igsocket>1)icNE>9ieINTT><)AL(?8ifFALSE?9);DB(A@D!A@EiiFD_ISSETA@F(A@NigsocketA@O,AAE&AAFihBNRPfdsAAG))AL(ABGifFALSEABH);DB(ACCigsocketACDicLTACKCM)AL(ADGifFALSEADH);DB(AGBiicheckArgAGC(AGKidtcbAGLpAGOieargsAHA[AHECM],AHH&AHJigoptionAHK)icNEAICihSYMBOLTAIF)AL(AJFifFALSEAJG);DB(AMAigstrcmpAMB(AMHignameofAMI(AMOigoptionAN@),ANGs)BMAOFCN){DB(B@IiicheckArgB@J(BABidtcbBACpBAFieargsBAH[BALCM],BAO&BBAifvalueBBB)icNEBBIieINTTBBL)AL(BCIifFALSEBCJ);DB(BDMifvalueBDNicLEBEDCN)AL(BFAifFALSEBFB);iferrnoBFL=BGBCN;iferrorBGH=BGNiksetsockoptBH@(BHJigsocketBHK,BIAikSOL_SOCKETBIC,BIMijSO_SNDBUFBIO,BJH(BJJihoptValTBJK*BKC)&BKEifvalueBKF,BKKCG(BLCifvalueBLD));}BMADCDB(BOMigstrcmpBON(C@DignameofC@E(C@KigoptionC@L),CACs)BMCBBCN){DB(CCEiicheckArgCCF(CCNidtcbCCOpCDBieargsCDD[CDHCM],CDK&CDMifvalueCDN)icNECEEieINTTCEH)AL(CFEifFALSECFF);DB(CGIifvalueCGJicLECH@CN)AL(CHMifFALSECHN);iferrnoCIH=CINCN;iferrorCJD=CJJiksetsockoptCJL(CKFigsocketCKG,CKMikSOL_SOCKETCKO,CLIijSO_RCVBUFCLK,CMD(CMFihoptValTCMG*CMO)&CNAifvalueCNB,CNGCG(CNOifvalueCO@));DB(D@DiferrorD@EBND@K-D@NCM){DB(DEFigsocketDEGBODENitpHighTSBufferNumberDFA){iiTSBufferDGJ*DHB*DHCihbufferPDHE=DHMiqgetSocketBufferPDHO(DIOigsocketDJ@);DB(DJN*DJOihbufferPDK@){iqensureBufferSizeEAK(EBKihbufferPEBL,ECCifvalueECE+ECKCM);}EDE}EDL}EDO}EEEDCALifFALSEEFO;ALifunifyEHB(EHGidtcbEHH,EHKidtcbEHMpEI@ieargsEIB[EIFCM],EIIihmakeintEIK(EJB&EJCidtcbEJDpEJGichpEJI,EJKiferrnoEJM));}EKF
BNRP_netname"13841 N {EAiename22,26ijipaddress28;c*3<ihmachine3>,45*47igchaddr49;EIihhostent5<*64ijhostentry66;EIilsockaddr_in7<ihaddress88;DB(98idtcb99p9<ihnumargs9>icNE:6CM)AL(;2ifFALSE;3);AM(<6iicheckArg<7(<?idtcb=0p=3ieargs=5[=9CM],=<&==iename=>)){ACihSYMBOLT?4:{EIihin_addrAAB*AAJieaddrAAL;ihmachineABJ=ACBignameofACD(ACJienameACK);ijhostentryADJ=AEDingethostbynameAEF(AFCihmachineAFD);DB(AICijhostentryAIDicEQAINieNULLAJA)AL(AJMifFALSEAJN);AM(ALDiicheckArgALE(ALMidtcbALNpAMAieargsAMC[AMGCM],AMJ&AMKijipaddressAML)){ACihSYMBOLTAOO:ihmachineBAD=BALignameofBAN(BBDijipaddressBBE);DB(BCOijinet_addrBD@(BDIihmachineBDJ)icEQBECilINADDR_NONEBEF)AL(BFIifFALSEBFJ);AP(BJF(BJGieaddrBJH=BJM(BJOEIihin_addrBKG*BKO)*BLAijhostentryBLBpBLKilh_addr_listBLMCEBMH)icNEBMLieNULLBMO){igchaddrC@C=C@J(C@Lc*CAB)ijinet_ntoaCAD(CAM*CANieaddrCAO);DB(CCHigstrcmpCCI(CCOigchaddrCD@,CDFihmachineCDG)icEQCE@CN)AL(CELieTRUECEM);}CG@AL(CHDifFALSECHE);ACieVARTCIJ:igchaddrCJL=CKC(CKEc*CKK)ijinet_ntoaCKM(CLF*CLG(CLHEIihin_addrCM@*CMH)ijhostentryCMJpCNCigh_addrCNE);AL(D@@ifunifyD@A(D@FidtcbD@G,D@JidtcbD@KpD@NieargsDA@[DADCM],DAGiuBNRPLookupTempSymbolDAH(DBLidtcbDBM,DC@igchaddrDCA)));AE:AL(DEOifFALSEDF@);}DG@}DGFACieVARTDHA:{imBNRP_BooleanDIEigresultDJB=DJIieTRUEDJK;AM(DKOiicheckArgDL@(DLHidtcbDLIpDLLieargsDLN[DMBCM],DME&DMFijipaddressDMG)){ACihSYMBOLTDOJ:ihaddressE@O.iisin_addrEAG.igs_addrEB@=EBGijinet_addrEBI(ECBignameofECC(ECIijipaddressECJ));DB(EEEihaddressEEF.iisin_addrEEN.igs_addrEFGicEQEFNilINADDR_NONEEGA)AL(EHDifFALSEEHE);ijhostentryEKI=ELCingethostbyaddrELE(EMB(EMCc*EMI)&EMKihaddressEML.iisin_addrEND,ENLCG(EOCihaddressEOD.iisin_addrEOL),F@EihAF_INETF@F);DB(FANijhostentryFAOicEQFBIieNULLFBL)AL(FCHifFALSEFCI);AB;ACieVARTFFB:ihmachineFGD=FGL(FGNc*FHD)ilBNRP_mallocFHF(FIAioMAXHOSTNAMELENFIB+FJACM);ilgethostnameFKC(FKNihmachineFKO,FLFioMAXHOSTNAMELENFLG);ijhostentryFND=FNNingethostbynameFO@(FOMihmachineFON);ijBNRP_freeGBO(GCHihmachineGCI);DB(GEAijhostentryGEBicEQGELieNULLGEO)AL(GFKifFALSEGFL);igchaddrGH@=GHG(GHIc*GHO)ijinet_ntoaGIA(GIJ*GIK(GILEIihin_addrGJD*GJL)ijhostentryGJNpGKGigh_addrGKI);igresultGLN=GMEifunifyGMG(GMLidtcbGMM,GN@idtcbGNApGNDieargsGNF[GNJCM],GNMiuBNRPLookupTempSymbolGNN(H@BidtcbH@C,H@FigchaddrH@G));AB;AE:AL(HDGifFALSEHDH);}HEHAL(HFHigresultHFIBLHG@ifunifyHGC(HGHidtcbHGI,HGLidtcbHGMpHH@ieargsHHB[HHFCM],HHIiuBNRPLookupTempSymbolHHJ(HINidtcbHIO,HJBijhostentryHJCpHJLigh_nameHJN)));}HKMAE:AL(HMJifFALSEHMK);}HNG}HNI
BNRP_networkConfiguration"16138 N {EAieport2?,33ikread_delay35,3?inconnect_delay41;igfd_set51ihtempfds58=60ihBNRPfds62;DB(72idtcb73p76ihnumargs78icNE80CM)AL(8<ifFALSE8=);AM(9?iicheckArg:0(:8idtcb:9p:<ieargs:>[;2CM],;5&;6ieport;7)){ACieINTT<=:DB(AJO(AK@ieportAKAicLTAKFCN)BKAKL(AKOieportAL@icGTALEijUSHRT_MAXALH))AL(AMJifFALSEAMK);ioBNRPlowestPortANK=AOJieportAOL;AB;ACieVARTBAJ:DB(BBJifunifyBBK(BC@idtcbBCA,BCDidtcbBCEpBCHieargsBCJ[BCNCM],BDAihmakeintBDB(BDI&BDJidtcbBDKpBDNichpBE@,BEBioBNRPlowestPortBEC))icEQBFDifFALSEBFG)AL(BGDifFALSEBGE);AB;AE:AL(BJGifFALSEBJH);}BKDAM(BL@iicheckArgBLA(BLIidtcbBLJpBLMieargsBLO[BMCCM],BMF&BMGikread_delayBMH)){ACieINTTBOD:ioBNRPread_timerCE@=CEOikread_delayCFA;AB;ACigFLOATTCHE:ioBNRPread_timerCNC=COB*COD(COEicfpCOF*COI)ikread_delayCOK;AB;ACieVARTDAO:DB(DBOifunifyDC@(DCEidtcbDCF,DCIidtcbDCJpDCMieargsDCO[DDCCM],DDFijmakefloatDDG(DE@&DEAidtcbDEBpDEEichpDEG,DEI&DEJioBNRPread_timerDEK))icEQDFLifFALSEDFO)AL(DGLifFALSEDGM);AB;AE:AL(DJOifFALSEDK@);}DKLAM(DLHiicheckArgDLI(DMAidtcbDMBpDMEieargsDMG[DMKCM],DMN&DMOinconnect_delayDN@)){ACieINTTDOO:irBNRPconnect_timerEEN=EG@inconnect_delayEGB;AB;ACigFLOATTEII:irBNRPconnect_timerEOJ=F@L*F@N(F@OicfpFA@*FAC)inconnect_delayFAE;AB;ACieVARTFCL:DB(FDLifunifyFDM(FEBidtcbFEC,FEFidtcbFEGpFEJieargsFEL[FF@CM],FFCijmakefloatFFD(FFM&FFNidtcbFFOpFGBichpFGD,FGF&FGGirBNRPconnect_timerFGH))icEQFHLifFALSEFHO)AL(FILifFALSEFIM);AB;AE:AL(FLOifFALSEFM@);}FMLAL(FNLieTRUEFNM);}FOD
selectSocket"17925 N {igfd_set28igreadfd2?;icfp38iesecs3;,3?ifusecs40;EIihtimeval4?ictm57;ihFD_ZERO5=(64&65igreadfd66);igFD_SET70(76igsocket77,7=&7?igreadfd80);DB(?9ihtimeout?:<A@BCO){ALigselectAAC(AAIigsocketAAJ+ABACM,ABD(ABFihfd_setTABG*ABO)&ACAigreadfdACB,ACH(ACMihfd_setTACN*ADF)ieNULLADH,ADL(ADNihfd_setTADO*AEG)ieNULLAEI,AEM(AEOEIihtimevalAFG*AFO)ieNULLAGA);}AGLifusecsAH@=AHFiemodfAHH(AHLihtimeoutAHM,AID&AIEiesecsAIF);ictmAIN.igtv_secAJA=AJH(AJJEA)iesecsAK@;ictmAKG.ihtv_usecAKJ=ALB(ALDEA)(ALJifusecsALK*AMACO);ALigselectANH(ANNigsocketANO+AOFCM,AOI(AOKihfd_setTAOL*B@D)&B@FigreadfdB@G,B@M(BABihfd_setTBAC*BAK)ieNULLBAM,BBA(BBCihfd_setTBBD*BBL)ieNULLBBN,BCB&BCDictmBCE);}BCK
selectSocketForWrite"18503 N {igfd_set30ihwritefd3?;icfp49iesecs58,5<ifusecs5>;EIihtimeval6=ictm75;ihFD_ZERO7;(82&83ihwritefd84);igFD_SET8?(95igsocket96,9<&9=ihwritefd9>);DB(;1ihtimeout;2<;:CO){ALigselect=2(=8igsocket=9+>0CM,>3(>5ihfd_setT>6*>>)ieNULL?0,?4(?=ihfd_setT?>*A@F)&A@HihwritefdA@I,AA@(AABihfd_setTAAC*AAK)ieNULLAAM,ABA(ABCEIihtimevalABK*ACC)ieNULLACE);}AD@ifusecsADD=ADJiemodfADL(AE@ihtimeoutAEA,AEH&AEIiesecsAEJ);ictmAFB.igtv_secAFE=AFL(AFNEA)iesecsAGD;ictmAGK.ihtv_usecAGN=AHF(AHHEA)(AHNifusecsAHO*AIECO);ALigselectAKB(AKHigsocketAKI+AL@CM,ALC(AMHihfd_setTAMI*ANA)ieNULLANC,ANG(ANIihfd_setTANJ*AOB)&AODihwritefdAOE,AOL(AONihfd_setTAOO*B@G)ieNULLB@I,B@M&B@OictmBA@);}BAE
enableNONBLOCK"19043 N {nifflags21;ifflags2==33iffcntl35(3:icfd3;,3=ihF_GETFL3?,46CN);DB(54ifflags55icNE5;-5>CM)ALiffcntl71(76icfd77,79ihF_SETFL7;,82ifflags84|8:ikO_NONBLOCK8<);DCAL-;1CM;};5
disableNONBLOCK"19231 N {nifflags22;ifflags2>=34iffcntl36(3;icfd3<,3>ihF_GETFL40,47CN);DB(55ifflags56icNE5<-5?CM)ALiffcntl72(77icfd78,7:ihF_SETFL7<,83ifflags85&8;~8=ikO_NONBLOCK8>);DCAL-;4CM;};8